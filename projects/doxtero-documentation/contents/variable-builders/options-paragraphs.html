<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Options Paragraph</title>
<link rel="stylesheet" href="../../assets/styles/style.css">
</head>


<body>
<div class="container">



<h1>Options Paragraph</h1>

  <div class="input-container">

      <h2>Insert Options Variable</h2>
      <input type="text" id="condition_input" placeholder="" />
   </div>

   <br>

    <div class="column-container">
        <div class="input-container color-light-yellow">
          <h2>ðŸ”» Insert Option Item</h2>
          <textarea id="new_option_input" placeholder=""></textarea>
          <br><br>
          <button id="add_option_button">Add Option</button><br>


        <br>
        <div class="options-list-container color-light-green">
          <h3>Current Options</h3>
          <div id="options_list" aria-live="polite" aria-label="List of current options">
            <!-- Dynamically added options appear here -->
          </div>
        </div>
  </div>

  <div class="output-container">
    <div>
      <h2>ðŸ”´ Style 1: <code>[[o? option variable]]</code></h2>
      <div id="output1" class="output-box" contenteditable="true" onclick="copyToClipboard(this)">No options yet.</div>
    </div>

    <div>
      <h2 class="output-title">ðŸŸ¢ Style 2: <code>((o? option variable))</code></h2>
      <div id="output2" class="output-box" contenteditable="true" onclick="copyToClipboard(this)">No options yet.</div>
    </div>
  </div>
</div>

<script>
const condition_input = document.getElementById('condition_input');
const new_option_input = document.getElementById('new_option_input');
const add_option_button = document.getElementById('add_option_button');
const options_list_div = document.getElementById('options_list');

let options = [];

function createOptionElement(text, index) {
  const container = document.createElement('div');
  container.className = 'option-item';
  container.dataset.index = index;

  const textarea = document.createElement('textarea');
  textarea.className = 'list-textarea';
  textarea.value = text;
  textarea.rows = 3;
  textarea.addEventListener('input', () => {
    options[index] = textarea.value;
    updateOutputs();
  });

  const btns = document.createElement('div');
  btns.className = 'list-buttons';

  const button_up = document.createElement('button');
  button_up.type = 'button';
  button_up.textContent = 'â†‘';
  button_up.title = 'Move Up';
  button_up.disabled = (index === 0);
  button_up.addEventListener('click', () => {
    if (index === 0) return;
    [options[index - 1], options[index]] = [options[index], options[index - 1]];
    renderOptions();
  });

  const button_down = document.createElement('button');
  button_down.type = 'button';
  button_down.textContent = 'â†“';
  button_down.title = 'Move Down';
  button_down.disabled = (index === options.length - 1);
  button_down.addEventListener('click', () => {
    if (index === options.length - 1) return;
    [options[index + 1], options[index]] = [options[index], options[index + 1]];
    renderOptions();
  });

  const button_delete = document.createElement('button');
  button_delete.type = 'button';
  button_delete.textContent = 'âœ•';
  button_delete.title = 'Delete Option';
  button_delete.style.backgroundColor = '#d9534f';
  button_delete.addEventListener('click', () => {
    options.splice(index, 1);
    renderOptions();
  });

  btns.appendChild(button_up);
  btns.appendChild(button_down);
  btns.appendChild(button_delete);

  container.appendChild(textarea);
  container.appendChild(btns);

  return container;
}

function renderOptions() {
  options_list_div.innerHTML = '';
  if (options.length === 0) {
    options_list_div.textContent = '[no options yet]';
  } else {
    options.forEach((opt, idx) => {
      options_list_div.appendChild(createOptionElement(opt, idx));
    });
  }
  updateOutputs();
}

function updateOutputs() {
  const condition = condition_input.value.trim();

  if (!condition) {
    document.getElementById('output1').textContent = '';
    document.getElementById('output2').textContent = '';
    return;
  }

  if (options.length === 0) {
    document.getElementById('output1').textContent = 'No options added.';
    document.getElementById('output2').textContent = 'No options added.';
    return;
  }

  // Replace newlines in each option with literal ' <br> '
  const escapedOptions = options.map(opt => opt.replace(/\n/g, '<br>'));
  const joinedOptions = escapedOptions.join('//');

  const output1 = `[[o? ${condition}]]${joinedOptions}[[/]]`;
  const output2 = `((o? ${condition}))${joinedOptions}((/))`;

  document.getElementById('output1').textContent = output1;
  document.getElementById('output2').textContent = output2;
}

add_option_button.addEventListener('click', () => {
  const val = new_option_input.value;
  if (!val.trim()) {
    alert('Please enter an option to add.');
    return;
  }
  options.push(val);
  new_option_input.value = '';
  renderOptions();
});

condition_input.addEventListener('input', updateOutputs);

renderOptions();

function copyToClipboard(el) {
  const text = el.textContent || el.innerText;
  navigator.clipboard.writeText(text).then(() => {
    el.classList.add('copied');
    setTimeout(() => el.classList.remove('copied'), 250);
  });
}






</script>

<br><br><br><br><br>
</div>
</body>
</html>
