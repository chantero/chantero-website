<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>List Values</title>
<link rel="stylesheet" href="../../assets/styles/style.css">
</head>

<body>

<div class="container">

  <h1>List Values</h1>

  <!-- Row 1: Inputs -->
  <div class="container-2rows">
    <div class="input-container">
      <div class="paste-container">
        <h2>≡ Multi-line Text Input (Vertical List)</h2>
        <textarea id="paste_input" rows="5" placeholder="Paste or type text here..."></textarea>
      </div>
    </div>

    <div class="input-container">
      <h2>⚟ Split List Items Input</h2>
      <div id="list_items"></div>
      <button id="add_line_button" type="button">Add Line</button>
      <button class="color-light-blue" id="to_uppercase" type="button">Upper</button>
      <button class="color-light-blue" id="to_lowercase" type="button">Lower</button>
      <button class="color-light-blue" id="to_titlecase" type="button">Title</button>
      <button class="color-red" id="clear_all" type="button">Clear</button>
    </div>
  </div>

  <br><br>

  <!-- Row 2: Outputs -->
  <div class="container-2rows">
    <div class="output-container">
      <h2>List Values </h2>
      <div class="note-yellow">
        Values joined with <code>|</code>
      </div>
      <div id="output_pipe" class="output-box" contenteditable="true" onclick="copyToClipboard(this)"></div>
    </div>


    <div class="output-container">
      <h2>Horizontal Line (Custom)</h2>
      <div class="note-yellow">
        Values joined with ➜ 

        <input id="custom_delimiter" 
               type="text" 
               value=", " 
               style="width:4em; 
                      text-align:center; 
                      font-weight:bold; 
                      border:4px solid #EC4899; 
                      background-color:white">

      </div>
      <div id="output_custom" class="output-box" contenteditable="true" onclick="copyToClipboard(this)"></div>
    </div>

<br><br><br>
</div>



<script>



const list_items_div = document.getElementById('list_items');
const add_line_button = document.getElementById('add_line_button');
const output_div = document.getElementById('output');
const pasteInput = document.getElementById('paste_input');

let lines = ['',]; // initial 1
let lineTextareas = [];   // store textarea references

// Create individual list item
function createLineElement(text, index) {
  const container = document.createElement('div');
  container.className = 'list-item';
  container.dataset.index = index;

  const textarea = document.createElement('textarea');
  textarea.className = 'list-textarea';
  textarea.value = text;
  textarea.rows = 3;
  textarea.addEventListener('input', () => {
    lines[index] = textarea.value;
    updateOutput();
    pasteInput.value = lines.join('\n');
  });

  const btns = document.createElement('div');
  btns.className = 'list-buttons';

  const button_up = document.createElement('button');
  button_up.type = 'button';
  button_up.textContent = '↑';
  button_up.disabled = (index === 0);
  button_up.addEventListener('click', () => {
    if (index === 0) return;
    [lines[index - 1], lines[index]] = [lines[index], lines[index - 1]];
    renderLines(index - 1); // preserve focus
  });

  const button_down = document.createElement('button');
  button_down.type = 'button';
  button_down.textContent = '↓';
  button_down.disabled = (index === lines.length - 1);
  button_down.addEventListener('click', () => {
    if (index === lines.length - 1) return;
    [lines[index + 1], lines[index]] = [lines[index], lines[index + 1]];
    renderLines(index + 1); // preserve focus
  });

  const button_delete = document.createElement('button');
  button_delete.type = 'button';
  button_delete.textContent = '✕';
  button_delete.style.backgroundColor = '#d9534f';
  button_delete.addEventListener('click', () => {
    lines.splice(index, 1);
    if (lines.length === 0) lines = ['', '', ''];
    renderLines(Math.min(index, lines.length - 1));
  });

  btns.appendChild(button_up);
  btns.appendChild(button_down);
  btns.appendChild(button_delete);

  container.appendChild(textarea);
  container.appendChild(btns);

  lineTextareas[index] = textarea;
  return container;
}

// Render all lines and optionally focus a specific index
function renderLines(focusIndex = null) {
  list_items_div.innerHTML = '';
  lineTextareas = [];

  lines.forEach((line, idx) => {
    list_items_div.appendChild(createLineElement(line, idx));
  });

  syncAll();

  if (focusIndex !== null && lineTextareas[focusIndex]) {
    lineTextareas[focusIndex].focus();
    const val = lineTextareas[focusIndex].value;
    lineTextareas[focusIndex].setSelectionRange(val.length, val.length);
  }
}

// Sync output and paste box
function syncAll() {
  updateOutput();
  pasteInput.value = lines.join('\n');
}


function updateOutput() {
  const filtered = lines.filter(line => line.trim() !== '');

  // Pipe-separated
  document.getElementById("output_pipe").innerText = filtered.join(" | ");

  // Always use value from the "form input" (even if empty or spaces)
  let customDelimiter = document.getElementById("custom_delimiter").value;

  // Interpret escapes (\n = newline, \t = tab)
  customDelimiter = customDelimiter
    .replace(/\\n/g, "\n")
    .replace(/\\t/g, "\t");

  // Custom-separated output
  document.getElementById("output_custom").innerText = filtered.join(customDelimiter);
}


// Attach live update when delimiter changes
document.getElementById("custom_delimiter").addEventListener("input", updateOutput);




// Apply a function to all lines and sync
function applyToLines(callback) {
  lines = lines.map(callback);
  lines.forEach((line, idx) => {
    if (lineTextareas[idx]) lineTextareas[idx].value = line;
  });
  syncAll();
}

// Event listeners
add_line_button.addEventListener('click', () => {
  lines.push('');
  renderLines(lines.length - 1); // focus on new line
});

pasteInput.addEventListener('input', () => {
  lines = pasteInput.value.split(/\r?\n/);
  renderLines();
});

document.getElementById('to_uppercase').addEventListener('click', () => {
  applyToLines(l => l.toUpperCase());
});

document.getElementById('to_lowercase').addEventListener('click', () => {
  applyToLines(l => l.toLowerCase());
});

document.getElementById('to_titlecase').addEventListener('click', () => {
  applyToLines(l => l.replace(/\w\S*/g, txt =>
    txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase()
  ));
});

document.getElementById('clear_all').addEventListener('click', () => {
  applyToLines(() => '');
});






// Copy output to clipboard
function copyToClipboard(el) {
  const text = el.textContent || el.innerText;
  navigator.clipboard.writeText(text).then(() => {
    el.classList.add('copied');
    setTimeout(() => el.classList.remove('copied'), 250);
  });
}

// Initial render
renderLines();




</script>

<script src="../assets/scripts/scripts.js"></script>
<br><br><br><br><br>
</div>
</body>
</html>
