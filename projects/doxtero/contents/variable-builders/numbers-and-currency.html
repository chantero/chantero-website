<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Numbers and Currency</title>
<link rel="stylesheet" href="../../assets/styles/style.css">
</head>
<body>
<div class="container">

<h1>Numbers and Currency</h1>

<div class="container-squished">

  <div class="form-group">
    <h2 for="variableInput">Variable Name</h2>

  <!-- Presets -->
  <div id="variable_presets_container">
    <div id="variable_presets_list">

      <span class="preset-button clear"><code>* clear *</code></span>

      <span class="preset-button"><code>price</code></span>
      <span class="preset-button"><code>purchase price</code></span>
    
      <span class="preset-button"><code>price: deposit</code></span>
      <span class="preset-button"><code>price: balance sum</code></span>

      <span class="preset-button"><code>price: earnest deposit</code></span>
      <span class="preset-button"><code>price: balance deposit</code></span>

      <span class="preset-button"><code>facility sum</code></span>

      <span class="preset-button"><code>facility total</code></span>
      <span class="preset-button"><code>facility: property</code></span>
      <span class="preset-button"><code>facility: legal fees</code></span>
      <span class="preset-button"><code>facility: valuation</code></span>
      <span class="preset-button"><code>facility: stamp duty</code></span>
      <span class="preset-button"><code>facility: sale price</code></span>
    </div>
  </div><br>


    <input type="text" id="variableInput" placeholder="" />
  </div>

  <div class="form-group">
    <h2 for="percentInput">Percent (optional)</h2>
    <input type="number" id="percentInput" placeholder="" min="0" />
  </div>

  <div class="form-group">
    <h2>Choose Method</h2>
    <div class="method-buttons" id="methodButtons"></div>
  </div>

  <br>

  <div class="output-container" id="outputContainer">
    <!-- Generated outputs appear here -->
  </div>

</div>

<script>
const methods = [
  'ringgit', 'num', 'aud', 'cad', 'gbp', 'usd', 'jpy', 'euro'
];

const methodButtonsDiv = document.getElementById('methodButtons');
const variableInput = document.getElementById('variableInput');
const percentInput = document.getElementById('percentInput');
const outputContainer = document.getElementById('outputContainer');

let selectedMethod = 'ringgit';

// Preset click handling
document.querySelectorAll('.preset-button').forEach(btn => {
  btn.addEventListener('click', () => {
    if (btn.classList.contains('clear')) {
      variableInput.value = '';
    } else {
      variableInput.value = btn.textContent.trim();
    }
    updateOutputs();
  });
});

methods.forEach(method => {
  const btn = document.createElement('button');
  btn.type = 'button';
  btn.textContent = method;
  if (method === selectedMethod) btn.classList.add('selected');

  btn.addEventListener('click', () => {
    selectedMethod = method;
    document.querySelectorAll('.method-buttons button').forEach(b => b.classList.remove('selected'));
    btn.classList.add('selected');
    updateOutputs();
  });

  methodButtonsDiv.appendChild(btn);
});

function genLine(variable, method, suffix = '', percent = null) {
  let methodStr = method + suffix;
  if (percent !== null) {
    methodStr += `:percent(${percent})`;
  }
  return `{{${variable} | ${methodStr}}}`;
}

function createOutputItem(label, text) {
  const container = document.createElement('div');
  container.className = 'output-box';

  const labelEl = document.createElement('div');
  labelEl.className = 'output-label';
  labelEl.textContent = label;

  const textEl = document.createElement('pre');
  textEl.textContent = text;

  container.appendChild(labelEl);
  container.appendChild(textEl);

  container.addEventListener('click', () => {
    navigator.clipboard.writeText(text).then(() => {
      container.classList.add('copied');
      setTimeout(() => container.classList.remove('copied'), 400);
    });
  });

  return container;
}

function updateOutputs() {
  outputContainer.innerHTML = '';

  const variable = variableInput.value.trim();
  if (!variable) {
    outputContainer.textContent = 'Please enter a variable name.';
    return;
  }

  const percentRaw = percentInput.value.trim();
  let percentNum = null;
  if (percentRaw !== '') {
    const p = Number(percentRaw);
    if (!Number.isFinite(p) || p < 0) {
      outputContainer.textContent = 'Percent must be a non-negative number.';
      return;
    }
    percentNum = p;
  }

  const outputs = [
    { label: `${selectedMethod}`, text: genLine(variable, selectedMethod) },
    { label: `${selectedMethod}_words`, text: genLine(variable, selectedMethod, '_words') },
    { label: `${selectedMethod}_describe`, text: genLine(variable, selectedMethod, '_describe') },
  ];

  if (percentNum !== null) {
    outputs.push(
      { label: `${selectedMethod}:percent(${percentNum})`, text: genLine(variable, selectedMethod, '', percentNum) },
      { label: `${selectedMethod}_words:percent(${percentNum})`, text: genLine(variable, selectedMethod, '_words', percentNum) },
      { label: `${selectedMethod}_describe:percent(${percentNum})`, text: genLine(variable, selectedMethod, '_describe', percentNum) },
    );
  }

  outputs.forEach(({label, text}) => {
    outputContainer.appendChild(createOutputItem(label, text));
  });
}

variableInput.addEventListener('input', updateOutputs);
percentInput.addEventListener('input', updateOutputs);




updateOutputs();
</script>

<br><br><br><br><br>
</body>
</html>
